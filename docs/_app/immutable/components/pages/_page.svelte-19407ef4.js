import{S as T,i as B,s as W,a2 as O,U as X,B as Y,w,x,y as v,f as g,t as _,z as I,o as tt,k as K,a as D,l as P,m as L,c as b,h as d,n as j,b as A,M as S,g as et,d as nt,Q as ot,D as k,a1 as rt,q as C,r as G,p as at}from"../../chunks/index-cdbf168b.js";import{c as q}from"../../chunks/shared-23917130.js";import{u as st,V as it,a as lt,W as ct,b as ft,D as mt,G as ut,c as z,H as M,P as $t}from"../../chunks/WorldViewer-ab41389d.js";import{G as pt}from"../../chunks/GLTF-d409b892.js";import{g as gt}from"../../chunks/navigation-dbfbfb45.js";function ht(c,t,n){let{position:e=void 0}=t,{rotation:o=void 0}=t,{movement:r}=t,{simple:i=!0}=t,l;const $={speed:Y(0)};O("threlte-car-context",$);const{world:m}=st(),E=new it;lt(()=>{const u=l==null?void 0:l.linvel();!u||(E.set(u.x,u.y,u.z),$.speed.set(E.length()))});const h={maxStabilizationIterations:m.maxStabilizationIterations,maxVelocityFrictionIterations:m.maxVelocityFrictionIterations,maxVelocityIterations:m.maxVelocityIterations};return m.maxStabilizationIterations*=100,m.maxVelocityFrictionIterations*=100,m.maxVelocityIterations*=100,X(()=>{m.maxStabilizationIterations=h.maxStabilizationIterations,m.maxVelocityFrictionIterations=h.maxVelocityFrictionIterations,m.maxVelocityIterations=h.maxVelocityIterations}),c.$$set=u=>{"position"in u&&n(0,e=u.position),"rotation"in u&&n(1,o=u.rotation),"movement"in u&&n(2,r=u.movement),"simple"in u&&n(3,i=u.simple)},[e,o,r,i]}class _t extends T{constructor(t){super(),B(this,t,ht,null,W,{position:0,rotation:1,movement:2,simple:3})}}function Z(c,t,n){const e=c.slice();return e[6]=t[n],e}function J(c){let t,n;return t=new pt({props:{castShadow:!0,receiveShadow:!0,url:q+"/models/city/scene.gltf",scale:2,rotation:{z:-.14*z,y:-1*z,x:4.8*z},position:{...c[6],y:-27.2}}}),{c(){w(t.$$.fragment)},l(e){x(t.$$.fragment,e)},m(e,o){v(t,e,o),n=!0},p:k,i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){_(t.$$.fragment,e),n=!1},d(e){I(t,e)}}}function dt(c){let t,n;return{c(){t=K("p"),n=C("Work in Progress"),this.h()},l(e){t=P(e,"P",{class:!0,style:!0});var o=L(t);n=G(o,"Work in Progress"),o.forEach(d),this.h()},h(){j(t,"class","text-xs text-black svelte-18jj3r3"),at(t,"padding","2rem")},m(e,o){A(e,t,o),S(t,n)},p:k,d(e){e&&d(t)}}}function yt(c){let t,n,e,o;return t=new M({props:{rotation:{y:-90*z},transform:!0,position:{x:-40,y:-13},$$slots:{default:[dt]},$$scope:{ctx:c}}}),e=new $t({props:{rotation:{x:-90*z,z:90*z,y:90*z},position:{y:.7,x:-.3,z:.35},fov:60}}),{c(){w(t.$$.fragment),n=D(),w(e.$$.fragment)},l(r){x(t.$$.fragment,r),n=b(r),x(e.$$.fragment,r)},m(r,i){v(t,r,i),A(r,n,i),v(e,r,i),o=!0},p(r,i){const l={};i&512&&(l.$$scope={dirty:i,ctx:r}),t.$set(l)},i(r){o||(g(t.$$.fragment,r),g(e.$$.fragment,r),o=!0)},o(r){_(t.$$.fragment,r),_(e.$$.fragment,r),o=!1},d(r){I(t,r),r&&d(n),I(e,r)}}}function wt(c){let t,n;return{c(){t=K("img"),this.h()},l(e){t=P(e,"IMG",{src:!0,alt:!0}),this.h()},h(){rt(t.src,n=q+"/logo/logo_main.png")||j(t,"src",n),j(t,"alt","Simul-City logo")},m(e,o){A(e,t,o)},p:k,d(e){e&&d(t)}}}function xt(c){let t,n,e,o,r;return{c(){t=K("p"),n=C("By"),e=D(),o=K("p"),r=C("Elijah Storm"),this.h()},l(i){t=P(i,"P",{class:!0});var l=L(t);n=G(l,"By"),l.forEach(d),e=b(i),o=P(i,"P",{class:!0});var $=L(o);r=G($,"Elijah Storm"),$.forEach(d),this.h()},h(){j(t,"class","svelte-18jj3r3"),j(o,"class","svelte-18jj3r3")},m(i,l){A(i,t,l),S(t,n),A(i,e,l),A(i,o,l),S(o,r)},p:k,d(i){i&&d(t),i&&d(e),i&&d(o)}}}function vt(c){let t,n,e,o,r,i,l,$,m,E,h,u;n=new mt({props:{position:{y:20,x:8,z:-3}}});let V=c[1],f=[];for(let a=0;a<V.length;a+=1)f[a]=J(Z(c,V,a));const N=a=>_(f[a],1,1,()=>{f[a]=null});return r=new ut({}),l=new _t({props:{movement:c[0],position:{y:.01,x:-5},rotation:{y:90*z},$$slots:{default:[yt]},$$scope:{ctx:c}}}),m=new M({props:{transform:!0,position:{y:5,x:-60,z:50},rotation:{y:90*z},$$slots:{default:[wt]},$$scope:{ctx:c}}}),h=new M({props:{transform:!0,position:{y:6,x:-50,z:0},rotation:{y:-180*z},$$slots:{default:[xt]},$$scope:{ctx:c}}}),{c(){t=K("div"),w(n.$$.fragment),e=D();for(let a=0;a<f.length;a+=1)f[a].c();o=D(),w(r.$$.fragment),i=D(),w(l.$$.fragment),$=D(),w(m.$$.fragment),E=D(),w(h.$$.fragment),this.h()},l(a){t=P(a,"DIV",{slot:!0});var s=L(t);x(n.$$.fragment,s),e=b(s);for(let y=0;y<f.length;y+=1)f[y].l(s);o=b(s),x(r.$$.fragment,s),i=b(s),x(l.$$.fragment,s),$=b(s),x(m.$$.fragment,s),E=b(s),x(h.$$.fragment,s),s.forEach(d),this.h()},h(){j(t,"slot","scene")},m(a,s){A(a,t,s),v(n,t,null),S(t,e);for(let y=0;y<f.length;y+=1)f[y].m(t,null);S(t,o),v(r,t,null),S(t,i),v(l,t,null),S(t,$),v(m,t,null),S(t,E),v(h,t,null),u=!0},p(a,s){if(s&2){V=a[1];let p;for(p=0;p<V.length;p+=1){const Q=Z(a,V,p);f[p]?(f[p].p(Q,s),g(f[p],1)):(f[p]=J(Q),f[p].c(),g(f[p],1),f[p].m(t,o))}for(et(),p=V.length;p<f.length;p+=1)N(p);nt()}const y={};s&512&&(y.$$scope={dirty:s,ctx:a}),l.$set(y);const R={};s&512&&(R.$$scope={dirty:s,ctx:a}),m.$set(R);const H={};s&512&&(H.$$scope={dirty:s,ctx:a}),h.$set(H)},i(a){if(!u){g(n.$$.fragment,a);for(let s=0;s<V.length;s+=1)g(f[s]);g(r.$$.fragment,a),g(l.$$.fragment,a),g(m.$$.fragment,a),g(h.$$.fragment,a),u=!0}},o(a){_(n.$$.fragment,a),f=f.filter(Boolean);for(let s=0;s<f.length;s+=1)_(f[s]);_(r.$$.fragment,a),_(l.$$.fragment,a),_(m.$$.fragment,a),_(h.$$.fragment,a),u=!1},d(a){a&&d(t),I(n),ot(f,a),I(r),I(l),I(m),I(h)}}}function It(c){let t,n;return t=new ct({props:{$$slots:{scene:[vt]},$$scope:{ctx:c}}}),{c(){w(t.$$.fragment)},l(e){x(t.$$.fragment,e)},m(e,o){v(t,e,o),n=!0},p(e,[o]){const r={};o&512&&(r.$$scope={dirty:o,ctx:e}),t.$set(r)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){_(t.$$.fragment,e),n=!1},d(e){I(t,e)}}}const U=3,F=140;function zt(c){const[t,n]=ft(),e={up:()=>n.onKeyDown("ArrowUp"),right:()=>n.onKeyDown("ArrowRight"),down:()=>n.onKeyDown("ArrowDown"),left:()=>n.onKeyDown("ArrowLeft")},o={up:()=>n.onKeyUp("ArrowUp"),right:()=>n.onKeyUp("ArrowRight"),down:()=>n.onKeyUp("ArrowDown"),left:()=>n.onKeyUp("ArrowLeft")},r=[{action:e.up,delay:6e3},{action:o.up,delay:4e3},{action:e.down,delay:400},{action:e.right,delay:600},{action:o.down,delay:400},{action:o.right,delay:1e3},{action:e.up,delay:0},{action:e.right,delay:500},{action:o.right,delay:1e3},{action:o.up,delay:2e3},{action:()=>{gt(`${q}/2d`)},delay:5e3}];tt(()=>r.reduce((l,$)=>(setTimeout($.action,l+$.delay),l+$.delay),0));const i=new Array(U**2).fill({}).map((l,$)=>({x:$%U*F-F,z:Math.floor($/U)*F-2*F-60}));return[t,i]}class St extends T{constructor(t){super(),B(this,t,zt,It,W,{})}}function Vt(c){let t,n;return t=new St({}),{c(){w(t.$$.fragment)},l(e){x(t.$$.fragment,e)},m(e,o){v(t,e,o),n=!0},p:k,i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){_(t.$$.fragment,e),n=!1},d(e){I(t,e)}}}class Kt extends T{constructor(t){super(),B(this,t,null,Vt,W,{})}}export{Kt as default};
