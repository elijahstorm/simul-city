import{S as Z,i as $,s as x,N as ee,E as te,k as P,a as R,w as ne,l as E,m as M,h as y,c as A,x as se,n as p,p as ae,b as B,M as k,y as ie,F as N,H as oe,I as le,J as re,f as V,t as z,z as he,a7 as ge,L as I,a8 as ue,o as de,a9 as fe}from"./index-cdbf168b.js";import{d as ce,p as L,a as J,l as K,c as U,E as _e,b as F,e as H,C as G,f as we}from"./Engine-4332f20a.js";let D;const me="network-canvas",q="transparent",ve="grey",X="black",j="white";let be;const pe=(e,n)=>t=>{if(!e)return t;const s={width:t.canvas.width/2.5,height:t.canvas.height/2.5};return D=D??ce(me,s).ctx,L(D,J(s),ye(be,n)),t},ye=(e,n)=>t=>{if(!e)return;const s=50,o=s,v=s,u=t.canvas.width-s*2,b=t.canvas.height-s*2,r=2;t.lineDashOffset=-n/50,t.lineWidth=r*2,t.fillStyle=X,t.fillRect(0,0,t.canvas.width,t.canvas.height),t.strokeStyle=X,t.strokeRect(r,r,t.canvas.width-r*2,t.canvas.height-r*2),t.strokeStyle=ve,t.strokeRect(r*3,r*3,t.canvas.width-r*6,t.canvas.height-r*6);const c=b/e.length;for(let d=e.length-1;d>=0;d--){const w=v+K(b-c,0,e.length==1?.5:d/(e.length-1));t.setLineDash([7,3]),ke(t,e[d],o,w,u,c,d==e.length-1?["T","L","Ri","B","Re"]:[])}return t},ke=(e,n,t,s,o,v,u)=>{const b=t+o,r=s+v,{inputs:c,outputs:d,weights:w,biases:_}=n;for(let i=0;i<c.length;i++)for(let g=0;g<d.length;g++)e.beginPath(),e.moveTo(O(c,i,t,b),r),e.lineTo(O(d,g,t,b),s),e.lineWidth=2,e.strokeStyle=T(w[i][g]),e.stroke();const f=18;for(let i=0;i<c.length;i++){const g=O(c,i,t,b);e.beginPath(),e.arc(g,r,f*.85,0,Math.PI*2),e.fillStyle=q,e.fill(),e.beginPath(),e.arc(g,r,f*.6,0,Math.PI*2),e.fillStyle=T(c[i]),e.fill()}for(let i=0;i<d.length;i++){const g=O(d,i,t,b);e.beginPath(),e.arc(g,s,f*.85,0,Math.PI*2),e.fillStyle=q,e.fill(),e.beginPath(),e.arc(g,s,f*.6,0,Math.PI*2),e.fillStyle=T(d[i]),e.fill(),e.beginPath(),e.lineWidth=2,e.arc(g,s,f*1,0,Math.PI*2),e.strokeStyle=T(_[i]),e.setLineDash([3,3]),e.stroke(),e.setLineDash([]),u[i]&&(e.beginPath(),e.textAlign="center",e.textBaseline="middle",e.fillStyle=j,e.strokeStyle=j,e.font=f*.9+"px Arial",e.fillText(u[i],g,s+f*.1),e.lineWidth=.5,e.strokeText(u[i],g,s+f*.1))}},O=(e,n,t,s)=>K(t,s,e.length==1?.5:n/(e.length-1)),T=e=>{const n=Math.abs(e),t=255,s=0,o=e>0?255:0;return`rgba(${t},${o},${s},${n})`};let S=0,Q=.06;U.controls.subscribe(({cameraSpeed:e})=>{Q=e});const Se=e=>n=>{if(n.save(),e){const t=e.box.angle-S,s=t>Math.PI?e.box.angle-Math.PI*2-S:t<-Math.PI?e.box.angle+Math.PI*2-S:t;S=(S+s*Q+Math.PI*2)%(Math.PI*2),n.translate(n.canvas.width/2,n.canvas.height/2),n.rotate(-S),n.translate(-e.box.x,-e.box.y)}return n},Ce=e=>(e.restore(),e);function Pe(e){let n,t,s,o,v,u,b,r,c,d,w,_,f,i;ee(e[9]);const g=e[8].default,m=te(g,e,e[7],null);return w=new _e({props:{input:e[0]}}),{c(){n=P("section"),t=P("canvas"),s=R(),o=P("canvas"),v=R(),u=P("canvas"),c=R(),m&&m.c(),d=R(),ne(w.$$.fragment),this.h()},l(a){n=E(a,"SECTION",{class:!0});var l=M(n);t=E(l,"CANVAS",{id:!0,style:!0,class:!0}),M(t).forEach(y),s=A(l),o=E(l,"CANVAS",{width:!0,height:!0}),M(o).forEach(y),v=A(l),u=E(l,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),M(u).forEach(y),c=A(l),m&&m.l(l),l.forEach(y),d=A(a),se(w.$$.fragment,a),this.h()},h(){p(t,"id","background-canvas"),ae(t,"display","none"),p(t,"class","svelte-1s5t62m"),p(o,"width",e[2]),p(o,"height",e[3]),p(u,"id","network-canvas"),p(u,"width",b=e[2]/2.5),p(u,"height",r=e[3]/2.5),p(u,"class","svelte-1s5t62m"),p(n,"class","view svelte-1s5t62m")},m(a,l){B(a,n,l),k(n,t),k(n,s),k(n,o),e[10](o),k(n,v),k(n,u),k(n,c),m&&m.m(n,null),B(a,d,l),ie(w,a,l),_=!0,f||(i=[N(window,"keydown",G.onkeydown),N(window,"keyup",G.onkeyup),N(window,"resize",e[9])],f=!0)},p(a,[l]){(!_||l&4)&&p(o,"width",a[2]),(!_||l&8)&&p(o,"height",a[3]),(!_||l&4&&b!==(b=a[2]/2.5))&&p(u,"width",b),(!_||l&8&&r!==(r=a[3]/2.5))&&p(u,"height",r),m&&m.p&&(!_||l&128)&&oe(m,g,a,a[7],_?re(g,a[7],l,null):le(a[7]),null);const C={};l&1&&(C.input=a[0]),w.$set(C)},i(a){_||(V(m,a),V(w.$$.fragment,a),_=!0)},o(a){z(m,a),z(w.$$.fragment,a),_=!1},d(a){a&&y(n),e[10](null),m&&m.d(a),a&&y(d),he(w,a),f=!1,ge(i)}}}function Re(e,n,t){let s,o,v,u;I(e,F,h=>t(12,o=h)),I(e,H,h=>t(14,u=h));let{$$slots:b={},$$scope:r}=n,{debug:c=!1}=n,{input:d=null}=n;const{simulation:w,controls:_}=U;I(e,w,h=>t(13,v=h)),I(e,_,h=>t(11,s=h)),ue(_,s.showNetwork=c,s);let f,i,g;de(()=>{F.set(f),H.set(o.getContext("2d")),a()});const m=h=>L(h,l,a),a=()=>v.destroyed?null:requestAnimationFrame(m),l=h=>{var W;return L(u,J({width:o.width,height:o.height}),Se(v.carSpots[s.cameraFocus]),we(v.world,(W=v.carSpots[s.cameraFocus])==null?void 0:W.box,v.carSpots,{width:o.width,height:o.height}),Ce,pe(s.showNetwork,h))};function C(){t(2,i=window.innerWidth),t(3,g=window.innerHeight)}function Y(h){fe[h?"unshift":"push"](()=>{f=h,t(1,f)})}return e.$$set=h=>{"debug"in h&&t(6,c=h.debug),"input"in h&&t(0,d=h.input),"$$scope"in h&&t(7,r=h.$$scope)},[d,f,i,g,w,_,c,r,b,C,Y]}class Ae extends Z{constructor(n){super(),$(this,n,Re,Pe,x,{debug:6,input:0})}}export{Ae as T};
